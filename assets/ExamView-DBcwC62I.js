import{n as E,h as S,r as n,j as e,f as A,p as $,d as k}from"./index-CRFdVEfv.js";const q=()=>{const{examId:o}=E(),p=S(),[l,g]=n.useState(null),[b,j]=n.useState(!0),[c,m]=n.useState([]),[i,u]=n.useState(0),[w,h]=n.useState(!1);n.useEffect(()=>{(async()=>{const s=A(k,"exams",o),t=await $(s);if(t.exists()){const r={id:t.id,...t.data()};g(r),m(new Array(r.questions.length).fill(null)),u((r.duration||30)*60)}else console.error("No such document!");j(!1)})()},[o]);const d=()=>{p(`/results/${o}`,{state:{userAnswers:c,exam:l}})};n.useEffect(()=>{if(i===0&&l&&d(),!i)return;const a=setInterval(()=>{u(i-1)},1e3);return()=>clearInterval(a)},[i]);const v=(a,s)=>{const t=[...c];t[a]=s,m(t)},N=()=>{c.every(s=>s!==null)?d():h(!0)};if(b)return e.jsx("div",{className:"spinner"});if(!l)return e.jsx("div",{children:"Exam not found"});const y=a=>{const s=Math.floor(a/60),t=a%60;return`${s}:${t<10?"0":""}${t}`};return e.jsxs("div",{className:"py-4 flex-grow",children:[w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-xl text-center w-11/12 md:w-auto",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"تحذير"}),e.jsx("p",{className:"mb-6",children:"لم تقم بالإجابة على جميع الأسئلة. هل أنت متأكد أنك تريد تسليم الامتحان؟"}),e.jsxs("div",{className:"flex justify-center space-x-4 space-x-reverse",children:[e.jsx("button",{onClick:d,className:"bg-green-600 text-white font-bold py-2 px-6 rounded-lg",children:"نعم، قم بالتسليم"}),e.jsx("button",{onClick:()=>h(!1),className:"bg-gray-500 text-white font-bold py-2 px-6 rounded-lg",children:"لا، ارجع للأسئلة"})]})]})}),e.jsx("div",{id:"exam-timer",className:"fixed top-4 left-4 bg-red-500 text-white p-2 rounded-lg shadow-lg",children:y(i)}),e.jsx("h2",{id:"exam-title",className:"text-3xl md:text-4xl font-bold text-gray-800 text-center mb-6",children:l.name}),e.jsx("div",{id:"questions-container",className:"space-y-8",children:l.questions.map((a,s)=>e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-md relative w-full md:h-[80vh]",children:[e.jsx("div",{className:"question-number-box",children:e.jsx("span",{children:s+1})}),e.jsx("div",{className:"question-points-box",children:e.jsxs("span",{children:[a.points||1," نقطة"]})}),e.jsx("p",{className:"text-lg md:text-3xl text-gray-800 mb-4 break-words pt-16",children:a.text}),e.jsx("div",{className:"space-y-3 md:space-y-8",children:a.options.map((t,r)=>{const x=typeof t=="string"?t:t.text,f=`option-${s}-${r}`;return e.jsxs("div",{className:"custom-radio p-2 rounded-lg",children:[e.jsx("input",{type:"radio",id:f,name:`question-${s}`,value:x,onChange:()=>v(s,x),className:"form-radio"}),e.jsx("label",{htmlFor:f,className:"text-gray-700 text-base md:text-2xl",children:x})]},r)})})]},s))}),e.jsx("div",{className:"flex justify-center mt-8",children:e.jsx("button",{onClick:N,className:"bg-green-600 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-transform transform",children:"تسليم"})})]})};export{q as default};
